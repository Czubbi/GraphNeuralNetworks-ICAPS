;Copyright 2018 The MITRE Corporation. All rights reserved. Approved for public release. Distribution unlimited 17-2122.
; For more information on CALDERA, the automated adversary emulation system, visit https://github.com/mitre/caldera or email attack@mitre.org
; This has 6 hosts, 3 user, 1 admin per host, 1 active account per host
(define (problem gen)
(:domain caldera)
(:objects id_ciFile id_clFile id_cgFile id_ckFile id_chFile id_cjFile - ObservedFile 
 str__bo str__cb str__i str__s str__james str__j str__bv str__bi str__t str__b str__ba str__z str__n str__e str__john str__cf str__bh str__cd str__bw str__bg str__mary str__m str__bp str__u str__bb str__alpha str__f str__bu str__bn str__cc - string 
 id_aDomain - ObservedDomain 
 id_byTimeDelta id_brTimeDelta id_bdTimeDelta id_wTimeDelta id_bkTimeDelta id_pTimeDelta - ObservedTimeDelta 
 id_oHost id_bjHost id_bqHost id_vHost id_bxHost id_bcHost - ObservedHost 
 num__31 num__45 num__30 num__17 num__38 num__44 num__23 num__24 num__37 num__51 num__52 num__16 - num 
 id_crSchtask id_cmSchtask id_coSchtask id_cnSchtask id_cpSchtask id_cqSchtask - ObservedSchtask 
 id_cxRat id_cwRat id_ceRat id_ctRat id_cuRat id_csRat id_cvRat - ObservedRat 
 id_ddShare id_daShare id_dcShare id_cyShare id_dbShare id_czShare - ObservedShare 
 id_gDomainUser id_kDomainUser id_cDomainUser - ObservedDomainUser 
 id_lDomainCredential id_hDomainCredential id_dDomainCredential - ObservedDomainCredential 
)
(:init     (knows id_ceRat)
     (knows id_vHost)
     (knows_property id_ceRat pexecutable)
     (knows_property id_ceRat phost)
     (knows_property id_vHost pfqdn)
     (mem_cached_domain_creds id_bcHost id_dDomainCredential)
     (mem_cached_domain_creds id_bjHost id_hDomainCredential)
     (mem_cached_domain_creds id_bqHost id_lDomainCredential)
     (mem_cached_domain_creds id_bxHost id_hDomainCredential)
     (mem_cached_domain_creds id_oHost id_dDomainCredential)
     (mem_cached_domain_creds id_vHost id_dDomainCredential)
     (mem_domain_user_admins id_bcHost id_gDomainUser)
     (mem_domain_user_admins id_bjHost id_kDomainUser)
     (mem_domain_user_admins id_bqHost id_gDomainUser)
     (mem_domain_user_admins id_bxHost id_cDomainUser)
     (mem_domain_user_admins id_oHost id_kDomainUser)
     (mem_domain_user_admins id_vHost id_cDomainUser)
     (mem_hosts id_aDomain id_bcHost)
     (mem_hosts id_aDomain id_bjHost)
     (mem_hosts id_aDomain id_bqHost)
     (mem_hosts id_aDomain id_bxHost)
     (mem_hosts id_aDomain id_oHost)
     (mem_hosts id_aDomain id_vHost)
     (prop_cred id_cDomainUser id_dDomainCredential)
     (prop_cred id_gDomainUser id_hDomainCredential)
     (prop_cred id_kDomainUser id_lDomainCredential)
     (prop_dc id_bcHost no)
     (prop_dc id_bjHost no)
     (prop_dc id_bqHost yes)
     (prop_dc id_bxHost no)
     (prop_dc id_oHost yes)
     (prop_dc id_vHost yes)
     (prop_dns_domain id_aDomain str__b)
     (prop_dns_domain_name id_bcHost str__bg)
     (prop_dns_domain_name id_bjHost str__bn)
     (prop_dns_domain_name id_bqHost str__bu)
     (prop_dns_domain_name id_bxHost str__cb)
     (prop_dns_domain_name id_oHost str__s)
     (prop_dns_domain_name id_vHost str__z)
     (prop_domain id_bcHost id_aDomain)
     (prop_domain id_bjHost id_aDomain)
     (prop_domain id_bqHost id_aDomain)
     (prop_domain id_bxHost id_aDomain)
     (prop_domain id_cDomainUser id_aDomain)
     (prop_domain id_dDomainCredential id_aDomain)
     (prop_domain id_gDomainUser id_aDomain)
     (prop_domain id_hDomainCredential id_aDomain)
     (prop_domain id_kDomainUser id_aDomain)
     (prop_domain id_lDomainCredential id_aDomain)
     (prop_domain id_oHost id_aDomain)
     (prop_domain id_vHost id_aDomain)
     (prop_elevated id_ceRat yes)
     (prop_executable id_ceRat str__cf)
     (prop_fqdn id_bcHost str__bh)
     (prop_fqdn id_bjHost str__bo)
     (prop_fqdn id_bqHost str__bv)
     (prop_fqdn id_bxHost str__cc)
     (prop_fqdn id_oHost str__t)
     (prop_fqdn id_vHost str__ba)
     (prop_host id_bdTimeDelta id_bcHost)
     (prop_host id_bkTimeDelta id_bjHost)
     (prop_host id_brTimeDelta id_bqHost)
     (prop_host id_byTimeDelta id_bxHost)
     (prop_host id_ceRat id_vHost)
     (prop_host id_pTimeDelta id_oHost)
     (prop_host id_wTimeDelta id_vHost)
     (prop_hostname id_bcHost str__bi)
     (prop_hostname id_bjHost str__bp)
     (prop_hostname id_bqHost str__bw)
     (prop_hostname id_bxHost str__cd)
     (prop_hostname id_oHost str__u)
     (prop_hostname id_vHost str__bb)
     (prop_is_group id_cDomainUser no)
     (prop_is_group id_gDomainUser no)
     (prop_is_group id_kDomainUser no)
     (prop_microseconds id_bdTimeDelta num__30)
     (prop_microseconds id_bkTimeDelta num__37)
     (prop_microseconds id_brTimeDelta num__44)
     (prop_microseconds id_byTimeDelta num__51)
     (prop_microseconds id_pTimeDelta num__16)
     (prop_microseconds id_wTimeDelta num__23)
     (prop_password id_dDomainCredential str__e)
     (prop_password id_hDomainCredential str__i)
     (prop_password id_lDomainCredential str__m)
     (prop_seconds id_bdTimeDelta num__31)
     (prop_seconds id_bkTimeDelta num__38)
     (prop_seconds id_brTimeDelta num__45)
     (prop_seconds id_byTimeDelta num__52)
     (prop_seconds id_pTimeDelta num__17)
     (prop_seconds id_wTimeDelta num__24)
     (prop_sid id_cDomainUser str__f)
     (prop_sid id_gDomainUser str__j)
     (prop_sid id_kDomainUser str__n)
     (prop_timedelta id_bcHost id_bdTimeDelta)
     (prop_timedelta id_bjHost id_bkTimeDelta)
     (prop_timedelta id_bqHost id_brTimeDelta)
     (prop_timedelta id_bxHost id_byTimeDelta)
     (prop_timedelta id_oHost id_pTimeDelta)
     (prop_timedelta id_vHost id_wTimeDelta)
     (prop_user id_dDomainCredential id_cDomainUser)
     (prop_user id_hDomainCredential id_gDomainUser)
     (prop_user id_lDomainCredential id_kDomainUser)
     (prop_username id_cDomainUser str__james)
     (prop_username id_gDomainUser str__mary)
     (prop_username id_kDomainUser str__john)
     (prop_windows_domain id_aDomain str__alpha)
)
(:goal   (and 
     (prop_host id_cvRat id_bqHost)
     (prop_host id_cxRat id_oHost)
     (prop_host id_cwRat id_bcHost)
     (prop_host id_ctRat id_bjHost)
     (prop_host id_cuRat id_bxHost)
)
)
)